#include "eigenPairs.h"


void main()
{
	double A[] = { 7, 3, 4, -11, -9, -2,
		-6, 4, -5, 7, 1,  12,
		-1, -9, 2, 2, 9, 1,
		-8, 0, -1, 5, 0, 8,
		-4, 3, -5, 7, 2, 10,
		6, 1, 4, -11, -7, -1};

	complex AA[36], V[36], D[6];

	double2complex(A, 6, 6, AA);

	eig(AA, 6, V, D);

	/*
	from Matlab:
	V =
                        0.5 -   2.9578550624051e-16i                        0.5 +   2.9578550624051e-16i         -0.130576569272953 +     0.107390947647849i         -0.130576569272953 -     0.107390947647849i         0.0612678851744871 +    0i         -0.247016090877782 +    0i
      -6.05237107853371e-16 -                   0.5i      -6.05237107853371e-16 +                   0.5i          0.515401906869439 +     0.163325676679032i          0.515401906869439 -     0.163325676679032i          0.539157389535459 +    0i          0.123508045438905 +    0i
       3.78991791951491e-17 +  1.07535842310282e-17i       3.78991791951491e-17 -  1.07535842310282e-17i          0.556081709801206 +                     0i          0.556081709801206 +                     0i         -0.453382350291178 +    0i         -0.823386969592614 +    0i
       2.73079130664056e-16 -  6.28620154200579e-16i       2.73079130664056e-16 +  6.28620154200579e-16i        -0.0858381162780376 -     0.162346002525858i        -0.0858381162780376 +     0.162346002525858i         -0.453382350291182 +    0i         -0.411693484796315 +    0i
      -6.73169068607457e-16 -                   0.5i      -6.73169068607457e-16 +                   0.5i           0.45568843467602 +     0.316341449174666i           0.45568843467602 -     0.316341449174666i           0.53915738953546 +    0i          0.123508045438906 +    0i
                        0.5 +                     0i                        0.5 +                     0i         0.0224392032226814 +     0.167104419841268i         0.0224392032226814 -     0.167104419841268i         0.0612678851744874 +    0i          -0.24701609087778 +    0i

	D = [5 - j6, 5 + j6, 1 - j2, 1 + j2, 4, 3]
	*/

	double B[] = { 5.15197005803858, -0.182416459042037, -0.170761842844651, 15.6464388401411, -3.68869113694087, 15.8542047363468, 8.48366077455532, -1.12440266045300,
		2.37484877140658, 3.70105945137025, -0.706002229249728, 13.5059104763138, -3.38673870407352, 13.9370162326175, 6.58457891399998, -1.83434640877195,
		2.72172917837454, -0.826643378311070, 6.24382623172147, -4.58583965148057, 3.33484274381192, -4.52760120369706, -6.31917063790350, -0.989731143410477,
		3.91570311460315, -2.01000099693252, 3.36113313827925, -10.4728555472318, 7.03703350131221, -12.5276810429248, -12.6451702100311, -4.14518885094596,
		-4.20639173330091, -0.770271683298932, -1.01246569115606, 16.2568586737342, -3.56197641931390, 15.4985752018899, 18.2268910461633, 6.68587316077676,
		-4.17061908395180, 1.58942606450120, -3.18371883894548, 9.77184542503145, -6.61376924080143, 12.3882193733266, 11.6745595830809, 4.60689461294855,
		-1.15604665821735, 0.236963939515831, -0.960445696172755, 18.4789225718329, -5.14072299866767, 17.1839889101644, 16.0357122465547, 2.18008819052041,
		-0.729127801813930, -1.69175969562610, 1.17117867012351, -2.46947813827514, -0.865995439798287, -0.638540564066479, 2.88070490407015, 6.51404460553406 };

	complex BB[64], V2[64], D2[8];

	double2complex(B, 8, 8, BB);

	eig(BB, 8, V2, D2);

	/*
	V = 
	-0.00543480340950324       -0.34574433001251        -0.242119353241707        -0.491538599384613         0.579408846829162         0.251167282720941         0.252794511461621         0.294400769228602
	-0.0195767588154253       -0.557238479516027        -0.151380309533859        -0.471589364209466        -0.178487714714563         0.512246451293566         0.120428764342548         0.563790452971605
	0.217453742355686         0.220044415928532        -0.358718412656387         0.0313663872828012        -0.521636671573043         0.327329263797704         0.582590368929144        -0.154613017391319
	-0.584759177309597         0.220575491864321       -0.0145024509384634         0.180750940022526         0.308189808849928        -0.296554798024078         0.468532522038999         -0.29044033198498
	0.00723773928951745        0.534771452247909         0.427735267666817        -0.519920162709881        0.0862218041786822        -0.564947425801129        0.0364477609609631         0.554045888278662
	0.28100557306608          -0.143319027723637         0.440160869592018        -0.123124782666211        -0.361348773124391         0.294725733151854        -0.552270376097912         0.255650204873037
	0.491783776577443         0.0238865681614006        -0.472674873589793          -0.4574581040341        0.0301942104056563        -0.214433198562199          0.20832737495356         0.290893535149539
	-0.538042738121148         0.407162896925588         0.435261316406797         -0.08714309877425         0.355560012947133         0.165586610906329        -0.113693811472517         0.173967865605615
	
	D = [1, 8, 2, 7, 3, 5, 6, 4]

	*/

	double C[] = { -0.445293304102773, 4.90634972287693, -0.878713477733992, 6.30363730185166,
		-6.39413572242872, 13.3536785709153, 1.66680187467294, 11.9447676898663,
		3.68424494757762, -6.6617191294905, -0.0600206459796676, -7.00428933839067,
		3.12092682065852, -5.20521249499678, -1.41298995307265, -2.84836462083286 };
	complex CC[16], V3[16], D3[4];

	double2complex(C, 4, 4, CC);

	eig(CC, 4, V3, D3);

	/* 
	V =
	0.476208840289665          0.73356468774491        -0.696771881347419          0.77767105885459
	0.767509014784138         0.173718965387788         -0.66849319450201         -0.20841624880193
	-0.303076831708999        0.645435848252347        0.0444628696616685        0.0347361338687727
	-0.30380830590405         0.122951761878727         0.256220310454747         0.592101167419186

	D = [4, 1, 2, 3]
	*/
}
